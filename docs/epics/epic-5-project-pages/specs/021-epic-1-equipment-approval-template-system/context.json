{
  "task_description": "Create Pydantic schemas for Equipment Approval Template System - defines data validation layer for EquipmentTemplate, EquipmentApprovalRequest, and InspectionConsultantType entities with JSONB support and bilingual fields",
  "scoped_services": ["backend"],
  "files_to_modify": [
    "backend/app/schemas/__init__.py"
  ],
  "files_to_create": [
    "backend/app/schemas/inspection_template.py"
  ],
  "files_to_reference": [
    "backend/app/schemas/contact.py",
    "backend/app/schemas/equipment.py",
    "backend/app/core/validators.py"
  ],
  "patterns": {
    "crud_structure": "All schemas follow Base/Create/Update/Response pattern. Base contains shared fields with validation, Create inherits from Base unchanged, Update has all fields optional with explicit None defaults, Response inherits from CamelCaseModel and includes id/timestamps",
    "validation_pattern": "Apply @field_validator with mode='before' to process text fields with sanitize_string before Pydantic validation. List all text fields in a single decorator",
    "jsonb_fields": "Use dict | None = None for JSONB storage (technical_spec_schema, technical_specifications). No default value, no Field() wrapper",
    "camelcase_conversion": "All Response schemas inherit from CamelCaseModel which automatically converts snake_case to camelCase for JSON serialization via alias_generator=to_camel",
    "bilingual_support": "Consultant types require both name (English) and name_he (Hebrew) fields, both are required (not optional)",
    "modern_type_hints": "Use Python 3.10+ syntax: Type | None instead of Optional[Type], list[Type] instead of List[Type]"
  },
  "existing_implementations": {
    "contact_py": "Shows complete Base/Create/Update/Response pattern with field validators applying sanitize_string to multiple text fields, modern type hints throughout",
    "equipment_py": "Shows JSONB usage (specifications: dict | None), nested response models (list[ChecklistResponse] = []), CamelCaseModel inheritance, datetime fields",
    "validators_py": "Provides CamelCaseModel base class with ConfigDict(from_attributes=True, alias_generator=to_camel, populate_by_name=True), sanitize_string function for XSS protection, field length constants (MIN_NAME_LENGTH, MAX_NAME_LENGTH, etc.)"
  },
  "key_insights": [
    "Base schema defines shared validation, Create inherits Base without modifications, Update duplicates fields but all optional",
    "Field validators list all applicable fields in single decorator: @field_validator('field1', 'field2', mode='before')",
    "JSONB fields: dict | None with no default - database handles None values",
    "Response schemas use CamelCaseModel for automatic snake_case â†’ camelCase conversion",
    "Nested relationships default to empty lists: list[ResponseModel] = []",
    "Modern Python 3.10+ union syntax used consistently: str | None, not Optional[str]"
  ],
  "schema_requirements": {
    "InspectionConsultantTypeResponse": {
      "fields": ["id: UUID", "name: str", "name_he: str", "created_at: datetime", "updated_at: datetime"],
      "base_class": "CamelCaseModel",
      "notes": "Response-only schema (no Base/Create/Update), both name fields required for bilingual support"
    },
    "EquipmentTemplate": {
      "base_fields": ["template_name: str", "template_name_he: str", "description: str | None", "technical_spec_schema: dict | None", "required_documents: list[str]", "consultant_type_ids: list[UUID]"],
      "validators": "sanitize_string on template_name, template_name_he, description",
      "jsonb_fields": "technical_spec_schema (defines expected fields like flow_rate, quantity)",
      "notes": "Defines reusable equipment type schemas"
    },
    "EquipmentApprovalRequest": {
      "base_fields": ["template_id: UUID", "project_id: UUID", "request_name: str", "technical_specifications: dict | None", "submitted_documents: list[str]", "approval_status: str", "notes: str | None"],
      "validators": "sanitize_string on request_name, notes",
      "jsonb_fields": "technical_specifications (actual values matching template schema)",
      "notes": "User submission instances following template structure"
    }
  },
  "validation_constants": {
    "from_validators": ["MIN_NAME_LENGTH", "MAX_NAME_LENGTH", "MAX_DESCRIPTION_LENGTH", "MAX_NOTES_LENGTH"],
    "usage": "Import from app.core.validators and use in Field(min_length=MIN_NAME_LENGTH, max_length=MAX_NAME_LENGTH)"
  },
  "created_at": "2026-01-29T19:09:04.553813",
  "updated_at": "2026-01-29T19:20:00.000000"
}
